An error occurred while executing the following cell:
------------------
# Compute information criteria for the 4 models
# Use Bayesian Bootstrapping together with
# pseudo Bayes Model Averaging
# See "Bayesian analysis with Python" p201
comp = az.compare(dict(zip(clusters, traces)), method="BB-pseudo-BMA")
comp
az.plot_compare(comp)
plt.savefig("gmm_chooseK_pymc3_waic.pdf")
------------------

---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~/miniconda3/envs/py37/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   3360             join_idx, lidx, ridx = self_jnlevels.join(other_jnlevels, how,
-> 3361                                                       return_indexers=True)
   3362 

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.Int64HashTable.get_item()

pandas/_libs/hashtable_class_helper.pxi in pandas._libs.hashtable.Int64HashTable.get_item()

KeyError: 0

The above exception was the direct cause of the following exception:

KeyError                                  Traceback (most recent call last)
/tmp/ipykernel_4941/3848547173.py in <module>
      5 comp = az.compare(dict(zip(clusters, traces)), method="BB-pseudo-BMA")
      6 comp
----> 7 az.plot_compare(comp)
      8 plt.savefig("gmm_chooseK_pymc3_waic.pdf")

~/miniconda3/envs/py37/lib/python3.7/site-packages/arviz/plots/compareplot.py in plot_compare(comp_df, insample_dev, plot_standard_error, plot_ic_diff, order_by_rank, figsize, textsize, labeller, plot_kwargs, ax, backend, backend_kwargs, show)
    157     # TODO: Add backend kwargs
    158     plot = get_plotting_function("plot_compare", "compareplot", backend)
--> 159     ax = plot(**compareplot_kwargs)
    160 
    161     return ax

~/miniconda3/envs/py37/lib/python3.7/site-packages/arviz/plots/backends/matplotlib/compareplot.py in plot_compare(ax, comp_df, figsize, plot_ic_diff, plot_standard_error, insample_dev, yticks_pos, yticks_labels, plot_kwargs, information_criterion, textsize, step, backend_kwargs, show)
     80 
     81     if insample_dev:
---> 82         scale = comp_df[f"{information_criterion}_scale"][0]
     83         p_ic = comp_df[f"p_{information_criterion}"]
     84         if scale == "log":

~/miniconda3/envs/py37/lib/python3.7/site-packages/pandas/core/series.py in __getitem__(self, key)
    940         if key_type == 'integer':
    941             if self.index.is_integer() or self.index.is_floating():
--> 942                 return self.loc[key]
    943             else:
    944                 return self._get_values(key)

~/miniconda3/envs/py37/lib/python3.7/site-packages/pandas/core/series.py in _get_value(self, label, takeable)
   1049             values[self.index.get_loc(key)] = value
   1050             return
-> 1051 
   1052     def _set_with(self, key, value):
   1053         # other: fancy integer or otherwise

~/miniconda3/envs/py37/lib/python3.7/site-packages/pandas/core/indexes/base.py in get_loc(self, key, method, tolerance)
   3361                                                       return_indexers=True)
   3362 
-> 3363             # Restore the dropped levels
   3364             # Returned index level order is
   3365             # common levels, ldrop_names, rdrop_names

KeyError: 0
KeyError: 0
